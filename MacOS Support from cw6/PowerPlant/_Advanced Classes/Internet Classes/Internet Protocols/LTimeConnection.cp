// ===========================================================================//	LTimeConnection.cp		   	PowerPlant 2.1		©1998-1999 Metrowerks Inc.// ===========================================================================//// Internet Time Protocol#ifdef PowerPlant_PCH#include PowerPlant_PCH#endif#include <LTimeConnection.h>#include <LInternetAddress.h>PP_Begin_Namespace_PowerPlantconst SInt32 kBaseInternetTime = -126144000;	//Jan 1, 1900 - 12:00:00 am in Mac time// ===========================================================================#pragma mark === LTimeConnection ===// ---------------------------------------------------------------------------//		¥ LTimeConnection// ---------------------------------------------------------------------------// ÊConstructorLTimeConnection::LTimeConnection(LThread& inThread)	: LInternetProtocol(inThread){}// ---------------------------------------------------------------------------//		¥ ~LTimeConnection// ---------------------------------------------------------------------------// ÊDestructorLTimeConnection::~LTimeConnection(){}UInt32LTimeConnection::GetTimeFrom(ConstStr255Param	inRemoteHost,								UInt16 inPort){	Connect(inRemoteHost, inPort);	UInt32 netTime;	WaitResponse(netTime);	Disconnect();	//Convert 'Net seconds to Mac seconds	netTime += kBaseInternetTime;	return netTime;}// ---------------------------------------------------------------------------//		¥ WaitResponse// ---------------------------------------------------------------------------//voidLTimeConnection::WaitResponse(UInt32 & outNetTime){	UInt32 dataSize = mRcvSize;	StPointerBlock theData((SInt32) mRcvSize);	Boolean	dataExpedited;	mEndpoint->ReceiveData(theData, dataSize, dataExpedited, mTimeoutSeconds);	PP_STD::memcpy(&outNetTime, theData, dataSize);}PP_End_Namespace_PowerPlant